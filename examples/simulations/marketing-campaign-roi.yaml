name: Digital Marketing Campaign ROI
category: Marketing
description: Evaluates the return on investment for digital marketing campaigns across multiple channels, considering conversion rates, customer lifetime value, and market dynamics
version: 1.0.0
tags: [marketing, digital-marketing, roi, conversion-optimization, customer-acquisition]

parameters:
  - key: totalBudget
    label: Total Campaign Budget
    type: number
    default: 50000
    min: 1000
    max: 1000000
    step: 1000
    description: Total budget allocated for the marketing campaign

  - key: ppcBudgetPercent
    label: PPC Budget Allocation (%)
    type: number
    default: 40
    min: 0
    max: 100
    step: 5
    description: Percentage of budget allocated to pay-per-click advertising

  - key: socialBudgetPercent
    label: Social Media Budget (%)
    type: number
    default: 30
    min: 0
    max: 100
    step: 5
    description: Percentage of budget allocated to social media advertising

  - key: contentBudgetPercent
    label: Content Marketing Budget (%)
    type: number
    default: 20
    min: 0
    max: 100
    step: 5
    description: Percentage of budget allocated to content marketing

  - key: emailBudgetPercent
    label: Email Marketing Budget (%)
    type: number
    default: 10
    min: 0
    max: 100
    step: 5
    description: Percentage of budget allocated to email marketing

  - key: targetAudience
    label: Target Audience
    type: select
    default: b2c-general
    options: [b2c-general, b2c-niche, b2b-smb, b2b-enterprise, e-commerce]
    description: Primary target audience for the marketing campaign

  - key: seasonality
    label: Campaign Seasonality
    type: select
    default: normal
    options: [off-season, normal, peak-season, holiday]
    description: Seasonal timing of the campaign affecting performance

  - key: competitionLevel
    label: Market Competition
    type: select
    default: moderate
    options: [low, moderate, high, saturated]
    description: Level of competition in the target market

  - key: avgOrderValue
    label: Average Order Value
    type: number
    default: 150
    min: 10
    max: 10000
    step: 10
    description: Average value of each customer purchase or conversion

  - key: customerLifetimeValue
    label: Customer Lifetime Value
    type: number
    default: 450
    min: 50
    max: 50000
    step: 50
    description: Expected total value from each acquired customer

groups:
  - name: Budget Allocation
    description: Distribution of marketing spend across channels
    parameters: [totalBudget, ppcBudgetPercent, socialBudgetPercent, contentBudgetPercent, emailBudgetPercent]
    
  - name: Market Context
    description: External factors affecting campaign performance
    parameters: [targetAudience, seasonality, competitionLevel]
    
  - name: Customer Economics
    description: Revenue and value metrics per customer
    parameters: [avgOrderValue, customerLifetimeValue]

outputs:
  - key: totalLeads
    label: Total Leads Generated
    description: Total number of qualified leads generated across all channels

  - key: totalConversions
    label: Total Conversions
    description: Total number of customers acquired from the campaign

  - key: costPerAcquisition
    label: Cost Per Acquisition
    description: Average cost to acquire each new customer

  - key: campaignROI
    label: Campaign ROI (%)
    description: Return on investment percentage for the entire campaign

  - key: lifetimeROI
    label: Lifetime Value ROI (%)
    description: ROI considering customer lifetime value

simulation:
  logic: |
    // Validate budget allocation doesn't exceed 100%
    const totalBudgetPercent = ppcBudgetPercent + socialBudgetPercent + 
                              contentBudgetPercent + emailBudgetPercent
    
    // Normalize if over 100%
    const normalizedPPC = totalBudgetPercent > 100 ? 
                         (ppcBudgetPercent / totalBudgetPercent) * 100 : ppcBudgetPercent
    const normalizedSocial = totalBudgetPercent > 100 ? 
                            (socialBudgetPercent / totalBudgetPercent) * 100 : socialBudgetPercent
    const normalizedContent = totalBudgetPercent > 100 ? 
                             (contentBudgetPercent / totalBudgetPercent) * 100 : contentBudgetPercent
    const normalizedEmail = totalBudgetPercent > 100 ? 
                           (emailBudgetPercent / totalBudgetPercent) * 100 : emailBudgetPercent
    
    // Calculate channel budgets
    const ppcBudget = totalBudget * normalizedPPC / 100
    const socialBudget = totalBudget * normalizedSocial / 100
    const contentBudget = totalBudget * normalizedContent / 100
    const emailBudget = totalBudget * normalizedEmail / 100
    
    // Base performance metrics by audience type
    const audienceMetrics = {
      'b2c-general': { cpcRange: [0.5, 2.0], conversionRate: 0.02 },
      'b2c-niche': { cpcRange: [1.0, 4.0], conversionRate: 0.035 },
      'b2b-smb': { cpcRange: [2.0, 8.0], conversionRate: 0.015 },
      'b2b-enterprise': { cpcRange: [5.0, 25.0], conversionRate: 0.008 },
      'e-commerce': { cpcRange: [0.3, 1.5], conversionRate: 0.025 }
    }
    
    // Seasonality multipliers
    const seasonalityMultipliers = {
      'off-season': 0.7,
      normal: 1.0,
      'peak-season': 1.4,
      holiday: 1.8
    }
    
    // Competition impact
    const competitionFactors = {
      low: 1.3,
      moderate: 1.0,
      high: 0.8,
      saturated: 0.6
    }
    
    const metrics = audienceMetrics[targetAudience]
    const seasonMultiplier = seasonalityMultipliers[seasonality]
    const compMultiplier = competitionFactors[competitionLevel]
    
    // Channel-specific performance modeling
    // PPC Performance
    const ppcCPC = metrics.cpcRange[0] + random() * (metrics.cpcRange[1] - metrics.cpcRange[0])
    const ppcClicks = ppcBudget / ppcCPC
    const ppcConversionRate = metrics.conversionRate * 1.2 * seasonMultiplier * compMultiplier * (0.8 + random() * 0.4)
    const ppcConversions = ppcClicks * ppcConversionRate
    
    // Social Media Performance
    const socialCPM = 5 + random() * 10  // Cost per 1000 impressions
    const socialImpressions = (socialBudget / socialCPM) * 1000
    const socialCTR = 0.01 + random() * 0.02  // 1-3% CTR
    const socialClicks = socialImpressions * socialCTR
    const socialConversionRate = metrics.conversionRate * 0.8 * seasonMultiplier * compMultiplier * (0.7 + random() * 0.6)
    const socialConversions = socialClicks * socialConversionRate
    
    // Content Marketing Performance
    const contentLeadsPerDollar = 0.1 + random() * 0.15  // Leads per dollar spent
    const contentLeads = contentBudget * contentLeadsPerDollar
    const contentConversionRate = metrics.conversionRate * 2.0 * compMultiplier * (0.8 + random() * 0.4)
    const contentConversions = contentLeads * contentConversionRate
    
    // Email Marketing Performance
    const emailCostPerSend = 0.02 + random() * 0.03
    const emailsSent = emailBudget / emailCostPerSend
    const emailOpenRate = 0.15 + random() * 0.15  // 15-30% open rate
    const emailCTR = 0.02 + random() * 0.03  // 2-5% CTR
    const emailClicks = emailsSent * emailOpenRate * emailCTR
    const emailConversionRate = metrics.conversionRate * 1.5 * (0.9 + random() * 0.2)
    const emailConversions = emailClicks * emailConversionRate
    
    // Aggregate results
    const totalLeads = round(ppcClicks + socialClicks + contentLeads + emailClicks)
    const totalConversions = round(ppcConversions + socialConversions + contentConversions + emailConversions)
    
    // Calculate ROI metrics
    const costPerAcquisition = totalConversions > 0 ? totalBudget / totalConversions : 0
    const immediateRevenue = totalConversions * avgOrderValue
    const lifetimeRevenue = totalConversions * customerLifetimeValue
    
    const campaignROI = totalBudget > 0 ? ((immediateRevenue - totalBudget) / totalBudget) * 100 : 0
    const lifetimeROI = totalBudget > 0 ? ((lifetimeRevenue - totalBudget) / totalBudget) * 100 : 0
    
    return {
      totalLeads: totalLeads,
      totalConversions: totalConversions,
      costPerAcquisition: round(costPerAcquisition * 100) / 100,
      campaignROI: round(campaignROI * 10) / 10,
      lifetimeROI: round(lifetimeROI * 10) / 10
    }